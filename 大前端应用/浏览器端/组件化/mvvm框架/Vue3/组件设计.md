# 组件设计
## 组件通信
### 父子组件
使用 props 和 @event - this.$emit 通信
### 兄弟组件
状态提升，转化为父子通信
### 跨多层级通信
provide - inject
### 全局通信
全局 EventBus 
## 逻辑复用
### 组合式函数
通常情况下不要异步调用组合式 api，不然会出现无法识别 vue 实例的现象。
~~~javascript 
import {ref, onMounted, onUnmounted} from 'vue';

export function useMouse() {
    const x = ref(0);
    const y = ref(0);

    function update(event) {
        x.value = event.pageX;
        y.value = event.pageY;
    }

    onMounted(() => window.addEventListener('mousemove', update));
    onUnmounted((0 => window.removeEventListener('mousemove', update)));
     
    return {x, y};
}
~~~
~~~javascript 
<script setup>
import {useMouse} from './mouse.js';
const {x, y} = useMouse();
</script>

<template>
    Mouse position is at: {{x}}, {{y}}
</template>
~~~
### 自定义指令
~~~javascript
app.directive('color', (el, binding) => {
    el.style.color = binding.value;
}) 
~~~
### 插件
~~~javascript 
export default {
    install: (app, options) => {
        app.config.globalProperties.$translate = (key) => {
            return key.split('.').reduce((o, i) => {
                if (o) return o[i]
            }, options)
        }
        app.provide('i18n', options);
    }
}
~~~
### mixin
~~~javascript
const mixin = {
    created() {
        console.log(1);
    }
}
createApp({
    created() {
        console.log(2);
    },
    mixins: [mixin]
})
~~~
### extends
~~~javascript
const CompA = {...};
const CompB = {
    extends: CompA
} 
~~~
## 组件复用
### 包含关系
使用嵌套子组件的方式实现包含关系
### 被包含关系
使用插槽的方式实现被包含关系