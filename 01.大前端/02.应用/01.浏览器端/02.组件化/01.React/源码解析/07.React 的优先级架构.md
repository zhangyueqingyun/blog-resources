# React 的优先级架构

😆 Hi，大家好，我是张玥卿云，一个面向未来编程的程序员！准备将 React 源码解析写成一系列文章分享给大家，希望大家喜欢~ 

## 一、 前言

当第一次 Fiber 树初始化完成后，会等待事件的发生产生对 Fiber 树的更新任务，react 会根据这些更新任务更新 Fiber 树并渲染到当前页面上。

在这个更新流程中，出现了四种不同的优先级：

- 事件优先级：根据派生事件的优先程度划分的优先级
- 更新优先级：更新 fiber 树的优先级
- 任务优先级：执行更新任务的优先级
- 调度优先级：调度优先级

下面我们详细介绍几种优先级。

## 二、事件优先级

React 按照事件的紧急程度将他们划分为 DiscreteEvent, UserBlockingEvent, ContinuousEvent，IdleEvent 等。

- DiscreteEvent: 离散事件，包括 click、keydown、focusin 等，这些事件的触发不是连续的，优先级为 0 （cancle click close contextmenu copy cut auxclick dblclick dragend dragstart drop focusin focusout input invalid keydown keypress keyup mousedown mouseup paste pause play pointercancel pointerdown pointerup ratechange reset resize seeked submit touchcancel touchend touchstart volumechange change selectionchange textInput compositionstart compositionupdate beforeblur afterblur beforeinput blur fullscreenchange focus hashchange popstate select selectstart）

- UserBlockingEvent: 用户阻塞事件，包括 drag、scroll、mouseover 等，连续触发、阻塞渲染，优先级为 1 (目前处理和 ContinuouseEvent 相同)

- ContinuousEvent: 连续事件，包括 canplay、error、audio标签的 timeupdate 和 canplay，优先级高，为2 (drag dragenter dragexit dragleave dragover mousemove mouseout mouseover pointermove pointerout pointerover scroll toggle touchmove wheel mouseenter mouseleave pointerenter mouseleave pointerenter pointerleave)

- IdleEvent