# HTTP 协议
 本文章部分内容引用自《白帽子讲浏览器安全》和其他网络博客。
## 一、概览
 Http 协议是基于请求-响应的形式交互数据的无状态协议。客户端（浏览器）发送一个 Http 请求到服务器，然后服务器返回一个响应信息，响应的数据包含请求状态信息和具体内容。

## 二、版本
http 目前有 1.0、1.1、2.0、3.0 四个版本。
### http 1.0 （tcp）
- 非持久链接，不可复用，每次请求都需要重新建立 TCP 连接（三次握手）。
- 支持请求方式： get、post、head
### http 1.1 (tcp)
- 支持长链接，默认不关闭，可以被每个请求复用。
- 提供管道机制，允许多个请求同时发送，增加并发性。
- 请求头新增 host 字段，用来处理服务器存在多个虚拟主机的情况。
- 提供身份认证机制，设置特殊的状态码和头部进行身份认证。
### http 2.0 (tcp)
- 支持全双工请求。
- 支持服务端推送。
- 支持利用二进制帧传递报头和数据。
- 增加头部信息压缩机制（gzip、compress）；增加头部信息索引表。
### http 3.0 (quic-udp)
QUIC (Quick UDP Internet Connections)是基于UDP的传输层协议，提供像 TCP 一样的可靠性。
- 优化了线头阻塞问题
- 自定义连接：在 quic 层中维护连接机制，端口变化，id 不变，就不需要重新建立连接。
- 自定义重传
- 无阻塞多路复用
- 自定义流量控制
## 三、http 连接建立的过程
### 基于 TCP 的三次握手：
- 客户端发送 [SYN] 标记的包，Seq 初始序列号为 x, 发送完成后客户端进入 SYN_SEND 状态。
- 服务器返回 [SYN,ACK] 服务端进入 SYN_SEND 状态。
- 客户端返回 [ACK]，进入 ESTABLISHED 状态，服务端接收到数据包后也进入 ESTABLISHED 状态。

### 基于 TCP 的四次挥手：
- 客户端发送 [FIN]，进入 CLOSE_WAIT_1 状态。
- 服务端发送 [ACK]，进入 CLOSE_WAIT 状态，客户端收到数据包进入 FIN_WAIT_2 状态。
- 服务端发送 [FIN] ，进入 LAST_ACK 状态。
- 客户端发送 [ACK] ，进入 TIME_WAIT 状态，服务端接受到数据包，关闭连接进入 CLOSE 状态。客户端等待固定时间后，未收到 ACK 包，便关闭连接。

### http 3.0 是基于 QUIC (UDP) 实现的，所以没有繁琐地创建连接的过程。
