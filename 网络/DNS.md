# DNS 原理即解析过程
引用"域名国家工程研究中心ZDNS"的 DNS 原理及解析过程详解专栏。
## 什么是 DNS
DNS 是域名系统，是因特网中的一项核心服务，是用于实现域名和IP地址相互映射的一个分布式数据库，能够使用户方便地访问互联网，而不用去记住能够被机器直接读取的IP数据传。

通过主机名，得到该主机名对应的 IP 地址的过程叫做域名解析。

## 域名结构
域名结构是树状结构：
- 跟服务器：最顶端是根服务器。
- 顶级域：跟服务器下一层是 .com、.net、.cn 等通用域和 .cn、.uk 等国家域。
- 二级域名：比如 baidu.com、taobao.com 等网上注册的二级域名，他们基本上是归企业和运维人员管理。

## DNS 解析流程
- 浏览器发起 DNS 解析请求。
- 是否命中本地缓存服务器，若命中返回。
- 向跟服务器查询，返回顶级域所在的权威服务器位置。
- 向顶级域权威服务器发起查询，返回二级域权威服务器地址。
- 向二级域权威服务器发起查询，返回所需地址。

## DNS 资源记录
记录一条域名信息映射关系，称之为资源记录（RR）。
当我们查询域名 zdns.cn 的时候，查询结果得到的资源记录结构体中由如下数据：
1. TTL, 就是生存周期，是递归服务器会在缓存中保存该资源记录的时长。
2. 网络/协议类型，它的代表的标识是 IN , IN 就是 internet ，目前 DNS 系统主要支持的协议是 IN。
3. type, 就是资源记录类型，一般的网站都是 A 记录（IPv4 的主机地址）。
4. rdata 是资源记录数据，就是域名关联的信息数据。

## DNS 服务器
常见的 DNS 服务器就两种：权威解析服务器和递归解析服务器。递归解析服务器也可以叫做 localDNS
### 权威解析服务器
DNS 权威服务器保存着域名空间中部分区域的数据，如果 DNS 服务器负责管辖一个或多个区域时，称此 DNS 服务器为这些区域的权威服务器。

根权威 DNS 或者二级权威服务器中的资源记录标记被指定为区域权威服务器的 DNS 服务器。 通过资源记录中列出服务器，其他服务器就认为它是该区域的权威服务器。这意味着在 NS 资源记录中指定的任何服务器都被其他服务器当作权威的来源，并且能肯定应答区域内所含名称的查询。
### 递归服务器
递归服务器在正常情况下，初始的时候里面没有任何域名解析数据，里面所有的域名解析数据都来自于它到权威解析服务器的查询结果，一旦查询完毕，递归服务器就会根据 TTL 时间在本地形成一条缓存记录，并为用户提供 DNS 的查询服务。